### Changelog

All notable changes to this project will be documented in this file. Dates are displayed in UTC.

Generated by [`auto-changelog`](https://github.com/CookPete/auto-changelog).

#### 0.1.1

- âœ¨ feat: init trigger node and action node [`efc29aa`](https://pagepeek/rayson-pagepeek/n8n-nodes-xyz/commit/efc29aaa6c1533e34121d223c7c53da8f444d87b)
- ğŸ fix: ä»“åº“åœ°å€æœ‰è¯¯ [`d90fbc4`](https://pagepeek/rayson-pagepeek/n8n-nodes-xyz/commit/d90fbc46f45f8dca2e4927bbd3288a363b6f2619)

#å¼€å‘n8n nodesï¼Œä¸‹åˆ—ä¸ºéœ€è¦å®ç°çš„nodeåˆ—è¡¨

éœ€è¦åšcredentialsçš„å®ç°ï¼Œcredentialsåªéœ€è¦im serveræä¾›çš„access_tokenï¼Œå…¶ä»–ä¿¡æ¯ä¸éœ€è¦ã€‚å…è®¸é…ç½®host
å¼€å‘æ—¶ä¸è¦å¼•å…¥å¤–éƒ¨åº“ï¼Œåœ¨å†…éƒ¨å°è£…

# Trigger Nodes
## OnMessage
æ¥å—BotEventæ¶ˆæ¯ï¼Œå¹¶æŠŠæ¶ˆæ¯å¾€åä¼ é€’

## OnMessageEdit
æ¥å—BotEventæ¶ˆæ¯ï¼Œä¸»è¦ä»¥ä¿®æ”¹ä¸ºä¸»

# Action Nodes
## ReadMessage
è¯»å–æŒ‡å®šæ¶ˆæ¯ï¼Œè¯·æ±‚ {host}/chatbot/v1/message/{room_id}/{?event_id}ï¼Œå¹¶åœ¨headerä¸­é™„å¸¦onMessageä¸­è¿”å›çš„access_tokenï¼Œæˆ–è€…é€šè¿‡credentialsä¸­è¿”å›çš„access_token

## SendTextMessage
å‘é€MessageContentï¼Œé€šè¿‡messageContentæè¿°æ–‡æœ¬ï¼Œå¹¶å¼•ç”¨æŒ‡å®šæ¶ˆæ¯ï¼Œè¯·æ±‚ {host}/chatbot/v1/send/{room_id}ï¼Œå¹¶åœ¨headerä¸­é™„å¸¦onMessageä¸­è¿”å›çš„access_tokenï¼Œæˆ–è€…é€šè¿‡credentialsä¸­è¿”å›çš„access_token

## SendMediaMessage
å‘é€äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¯·æ±‚ {host}/chatbot/v1/upload/{room_id}ï¼Œå¹¶åœ¨headerä¸­é™„å¸¦content-typeï¼Œcontent-lengthï¼ŒonMessageä¸­è¿”å›çš„access_tokenï¼Œæˆ–è€…é€šè¿‡credentialsä¸­è¿”å›çš„access_token

```golang
type BotEvent struct {
	*MessageEvent

	BotName      string `json:"bot_name"`
	AccessToken  string `json:"access_token"`
	ResponseMode string `json:"response_mode"`
}

type MessageEvent struct {
	EventID        string          `json:"event_id"`
	RoomID         string          `json:"room_id"`
	Type           string          `json:"type"`
	Sender         string          `json:"sender"`
	OriginServerTS spec.Timestamp  `json:"origin_server_ts"`
	Content        *MessageContent `json:"content,omitempty"`
	Membership     *string         `json:"membership,omitempty"`
	StateKey       *string         `json:"state_key,omitempty"`
}

type MessageContent struct {
	MsgType       string       `json:"msg_type"`                 // m.text, m.image, m.video, m.audio, m.file
	Body          string       `json:"body"`                     // æ–‡æœ¬å†…å®¹
	FormattedBody *string      `json:"formatted_body,omitempty"` // HTMLæ ¼å¼å†…å®¹ï¼ˆå¯é€‰ï¼‰
	Format        *string      `json:"format,omitempty"`         // æ ¼å¼ï¼ˆå¯é€‰ï¼‰
	Mentions      []string     `json:"mentions,omitempty"`       // @ç”¨æˆ·åˆ—è¡¨
	ReplyTo       *ReplyTo     `json:"reply_to,omitempty"`       // å¼•ç”¨æ¶ˆæ¯ï¼ˆå¯é€‰ï¼‰
	File          *MessageFile `json:"file,omitempty"`           // å¤šåª’ä½“æ–‡ä»¶ä¿¡æ¯
}

type MessageFile struct {
	Url       string         `json:"url"`
	Mimetype  string         `json:"mimetype"`
	Size      int            `json:"size"`
	Width     *int           `json:"width,omitempty"`
	Height    *int           `json:"height,omitempty"`
	Thumbnail *ThumbnailFile `json:"thumbnail,omitempty"`
}

type ThumbnailFile struct {
	Url      string `json:"url"` // ç¼©ç•¥å›¾ä¸­çš„urlä¸ºç©ºä¼šå°è¯•æ ¹æ®å®½é«˜ç”Ÿæˆç¼©ç•¥å›¾
	Mimetype string `json:"mimetype"`
	Size     int    `json:"size"`
	Width    int    `json:"width,omitempty"`
	Height   int    `json:"height,omitempty"`
}

type ReplyTo struct {
	EventID string `json:"event_id"`
}
```
